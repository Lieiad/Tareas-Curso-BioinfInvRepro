---
title: "phangorn"
output: html_document
---

##Parsimonia

Script para construir un árbol de parsimonia  con la matriz concatenada ITS+ndhF-rpl32 de Antiphytum (Boraginaceae) usando el paquete Phangorn de R en CRAN

+ Limpiar variables y funciones de la memoria para la sesión actual
```{r}
rm(list=ls())
```


+ Cargar librerías
```{r}
library("phangorn")
```

+ Cargar datos
```{r}
conc <- read.phyDat("combinada.nex", format = "nexus")
```

+ Reconstruir un árbol usando Ratchet
```{r}
treeR <- pratchet(conc, trace = 0) 
```

+ Contar el número de pasos
```{r}
parsimony(treeR, conc) 
```

+ Enraizar el árbol con Echium vulgare
```{r}
treeR=root(treeR, outgroup = 1)
```

+ Obtener indice de consistencia (CI) y retencion (RI)
```{r}
x=CI(treeR, conc)
y=RI(treeR, conc)
ind=numeric(0)
ind=rbind(c(round(x,2),y))
colnames(ind)=c("CI", "RI")
rownames(ind)="Índices"
```

+ Observar el árbol
```{r}
plot(treeR, main="treeT", cex=0.6)
```

+ Asignar longitud de ramas y nodos internos al árbol con ACCTRAN
```{r}
treeR=acctran(treeR,conc)
plot(treeR, main="treeT", cex=0.6)
```

+ Calcular estados ancestrales
```{r}
anc.acctran = ancestral.pars(treeR, conc, "ACCTRAN")
anc.mpr= ancestral.pars(treeR, conc, "ACCTRAN")
```

+ Graficar estados ancestrales
```{r}
plotAnc(treeR, anc.mpr, 17, cex.pie = 0.1, cex=0.6)
plotAnc(treeR, anc.acctran, 17, cex.pie = 0.1)
```
